## 四、系统设计

### 1、前端交互

#### 基于参赛者的视角

##### 注册、登录、身份验证

用户可以点击右上角的登录进入登陆界面进行账户登录或是账号注册，平台也提供忘记密码时能够重设密码的功能。对于普通用户（参赛方）而言，邮箱是注册时欲加入用户所需要提供的，也是寻回密码的途径。注册后平台将发送一封带有验证链接的验证信到该邮箱地址，用户必须点击验证身份后才能激活账号。

<img src="image\login.png" style="zoom: 18%;" /><img src="image\frontend_email_verification.png" style="zoom: 18%;" /><img src="image\password_reset.png" style="zoom: 24%;" /><img src="image\register_user_error.png" style="zoom: 18%;" />



##### 平台主页浏览

平台主页最上面会有热门赛事的轮播，点击后可以快速进入该竞赛的竞赛详情页面。下面也有列出几种热门赛事类别（包含数学竞赛、物理竞赛、计算机竞赛、文学竞赛、艺术竞赛等）的部分竞赛，方便用户及时定位这些类别的竞赛，同时还会在右侧提供快捷查询按键，点击后可以快速跳转至查找特定类别竞赛的搜寻页面。

<img src="image/homepage.png" style="zoom: 25%;" />



##### 竞赛、用户搜索

平台除了提供简单地使用关键词查找竞赛之外，还提供在不同字段进行查找的功能，例如竞赛名称、竞赛主办方名称、关键词、竞赛类别、竞赛进行状态、个人赛或团体赛等，能够点击搜索得出的竞赛列表下方的竞赛详情按钮进入竞赛详情页面，进行竞赛查看、报名、作品提交等等功能。我们也提供按用户名、院校、就读专业、学生证号等等进行用户搜索，能够通过搜索到的用户列表进入其他用户的用户页面查看部分公开信息，以及利用聊天栏进行联系。

<img src="image\frontend_search_contest.png" style="zoom: 18%;" /><img src="image\frontend_search_user.png" style="zoom: 18%;" />



##### 用户中心

用户可以在用户中心进行身份验证、信息修改、密码修改、管理组队码、查看竞赛、查看消息等。

* 个人信息：对于尚未进行身份验证的用户可以点击”验证身份“利用学信网验证码或学信网证件号码自动验证，验证后可以自动更新真实姓名、就读学校、就读专业、学生号码等。对于无法使用学信网进行验证的用户（例如：海外大学生），平台也提供人工验证功能，可以上传证明文件提交到平台管理员处进行审核，审核通过后管理员会根据提交的文件进行身份信息录入。用户也可以在此页面进行头像、手机号、联系地址、个人简介的修改，以及平台账户密码的修改。平台使用”组队码“机制实现组队竞赛功能，用户可以在此页面查看组队码和手动刷新组队码。
* 我的竞赛：用户可以在此页面查看自身报名成功的竞赛。设有”作品提交中的竞赛“和”历史竞赛“，可以让用户快速查找自己需要提交作品的竞赛和已经结束的竞赛以供快速获取参赛证书的管道。
* 消息中心：可以浏览系统信息、用户间的站内交流信息、以及和竞赛主办方的联系信息。

<img src="image\frontend_usercenter_info_guest.png" style="zoom: 18%;" /><img src="image\frontend_usercenter_info.png" style="zoom: 18%;" />

<img src="image\frontend_usercenter_contest.png" style="zoom: 18%;" /><img src="image\frontend_usercenter_message.png" style="zoom: 18%;" />



#### 基于竞赛举办者的视角

##### 竞赛举办者的身份验证、账户注册

竞赛举办者可以点击右上角的登录进入登陆界面进行账户登录或是账号注册，平台也提供忘记密码时能够重设密码的功能。对于竞赛举办者而言，注册时除了需要提供邮箱地址外，还需要提供联系平台管理员验明官方身份后所获得的“组织者邀请码”。注册后平台将发送一封带有验证链接的验证信到该邮箱地址，用户必须点击验证身份后才能激活账号。

<img src="image\register_sponsor.png" style="zoom: 18%;" />



##### 竞赛管理页面：创建竞赛、竞赛管理、通知中心

竞赛举办者可以点击右上角头像进入竞赛管理页面，并在页面不同页签中进行创建竞赛、浏览竞赛、以及浏览通知与信息等操作。

* 创建竞赛：平台竞赛创建有两阶段：第一阶段输入竞赛基本的项目信息，包含竞赛名称、竞赛模块、竞赛简介、竞赛为个人赛还是团体赛、竞赛各阶段时间段等；第二阶段则可支持主办方增加文本或图片作为竞赛详情，平台提供用户友好且简单明瞭的简易编辑器，避免用户在格式上花费过多心力，同时还能在竞赛详情页面解析时保证格式统一，保证平台一致性及美观度，同时避免注入攻击。输入所有信息后即可创建竞赛，并等待平台管理员审核竞赛后方可上架竞赛。
* 浏览竞赛：可以选择页面上方的页签根据竞赛的不同状态进行筛选。
* 通知中心：除了可以浏览系统信息之外，也可以接收参赛方的消息，与参赛方进行沟通和答疑。

<img src="image\frontend_sponsor_contest_create.png" style="zoom: 18%;" /><img src="image\frontend_sponsor_contest_create_detail.png" style="zoom: 18%;" />

<img src="image\frontend_sponsor_contest_list.png" style="zoom: 18%;" /><img src="image\frontend_sponsor_message.png" style="zoom: 18%;" />



##### 针对个别竞赛的管理页面：公告管理、报名管理、评分和奖项；通知中细腻

竞赛举办者可以针对个别竞赛进行管理，管理的内容包含该竞赛的公告管理、报名管理、评分奖项管理，而在此页面平台也设置了通知中心页面，方便竞赛举办者在管理个别竞赛时也能够方便地得到系统消息和其他站内信息。

* 公告管理：竞赛举办者可以在此页面对已经发布的公告进行编辑或删除，也可以创建新公告。公告内除了标题和正文外，可以附加链接和一个附件（因此多个文件需要打包上传）。
* 报名管理：竞赛举办者可以在此页面查看报名者的信息，审核参赛方是否符合竞赛预期要求，选择是否通过参赛者的报名申请。同时，平台提供批量通过或拒绝的功能，方便竞赛举办者快速批量审核报名申请。
* 评分和奖项管理：竞赛举办者可以在此页面批量下载所有参赛用户提交的作品资料，对用户进行网上评分，同时可以支持下载`.csv`格式的打分表并在填好后上传打分表进行评分。在设置好分数后，平台提供根据分数段进行奖项设置的功能。

<img src="image\frontend_contest_notice.png" style="zoom: 18%;" /><img src="image\frontend_contest_apply_manage.png" style="zoom: 18%;" />

<img src="image\frontend_contest_score.png" style="zoom: 18%;" /><img src="image\frontend_contest_prize.png" style="zoom: 18%;" />



#### 基于网站管理员的视角

##### 竞赛发布的审核

网站管理员能够审核由竞赛举办方发起的竞赛创建申请，能够透过点击”查看预览“快速查看创建的竞赛详情进行审核。竞赛主办方可以通过或拒绝申请，并且可以填写审核理由，将由系统发送信息给竞赛举办方。

<img src="image\frontend_admin_contest.png" style="zoom: 18%;" />



##### 管理和生成竞赛主办方

网站管理员管理竞赛主办方的资格。竞赛举办方想要使用平台时可以联系网站管理员，管理员会在审核其资格后为其生成一个1竞赛举办方注册账户时需要提供者”组织者邀请码“，同时为此邀请码绑定官方名称。

<img src="image\frontend_admin_sponsor.png" style="zoom: 18%;" />



##### 人工审核用户身份验证信息

管理员能够审核无法使用学信网自动验证身份的用户的身份验证申请。管理员能够在用户实名信息审核页签获取申请的验证文件，决定是否通过用户的人工审核信息，系统会自动发送审核消息到申请用户的消息中心。对于要通过的申请，管理员需要根据提交的申请文件填写此用户的真实姓名、院校、专业、证件号码等信息。

<img src="image\admin_manual.png" style="zoom: 25%;" />



#### 基于其他用户的视角

##### 游客可以浏览竞赛和查看部分公告

即使没有登录平台，游客仍可以进入网站首页查看现在的竞赛。同时也能通过小程序进行竞赛列表浏览。

<img src="image\frontend_homepage_guest.png" style="zoom: 25%;" /><img src="image\mini_homepage.jpg" style="zoom: 18%;" />



## 五、重难点问题及其解决办法

### 1、前端部分

#### 创建竞赛

为了避免JS代码注入攻击、统一竞赛详情解析格式，以及适配平台自己实现的图床，我们为竞赛创建设计了一套简单的编辑器，支持使用文字和图片描述竞赛详情。虽然在用户层面创建竞赛就是几个按钮和输入的事，但是前端在代码实现上会需要先请求一些图片的命名位置，接着对每一张图片分别进行上传，然后将每一张图片加入该竞赛详情的对应位置，因此其实是用户按一次按钮是好几次请求和服务器回复的来回往复。并且为了避免竞赛描述为空，我们需要在详情组件内容更动时发送信号给父组件更新状态，是本部分实现上比较复杂的一部分。另外，在选择时间段时因为没有限制时间先后，因此需要手动使用代码将顺序调成有先后之分，同时还要不断根据其他时间段的范围去限制时间段的可选范围，在发送时统一调整时间段的开始为时间段起始当天的00:00，结束为时间段结束当天的23:59。

#### 时间统一

后端判断时间的基准是北京时间（UTC+08:00），而前端组件选择的时间是世界协调时间，因此我们项目刚开始时解析的时间和后端的时间是不一致的。后来我们通过在创建竞赛时手动添加28800秒（也就是8小时）来统一前后端时间，解决了时区不一致的问题





## 六、产品特色及亮点：

1. 对验证证书有良好的支持，提供二维码扫描验证证书真实性。
2. 对文件操作有良好的支持，提供用户进行证书批量下载、主办方作品批量下载和上传打分表等。
3. 提供良好的站内信息通知，不仅能接收系统信息，还能利用消息中心和其他用户及主办方联系。
4. 提供快捷键操作，例如登陆时可以在输完账号密码后敲击回车键快速登陆、在消息栏输入完消息后敲击回车发送消息。
5. 对于未登录的游客提供部分服务，方便游客能够在尚未加入平台时了解平台情况。

### 前端组织架构合理

由于平台提供众多功能，本项目的前端架构庞大，总共实现了13个页面（`views`），12类组件共31个组件（`components`），4个混入对象（`mixins`）和1个网络请求模块。

##### 13页面和组件

根据用户类型有不同的个人中心或管理页面：

|              |               普通用户                |               竞赛举办方                | 平台管理员  |
| :----------: | :-----------------------------------: | :-------------------------------------: | :---------: |
| 页面文件名称 |           `UserCenterPage`            |            `ManagementPage`             | `AdminPage` |
| 其他专属页面 | `CertificatePage`：可在线验证证书页面 | `ContestManagePage`：特定竞赛的管理页面 |             |

其他通用页面：

1. `ContestDetailPage`：竞赛详情页面。
2. `ErrPage`：错误Url页面，将在5秒后自动将用户导向竞赛平台首页。
3. `HomePage`：竞赛平台首页。
4. `LoginPage`：竞赛平台登录页面。
5. `RegisterPage`：账户注册页面。
6. `ResetPasswordPage`：重置密码页面。
7. `SearchPage`：搜索页面。
8. `UserPage`：其它用户和与该用户的聊天页面。

##### 4个混入对象（`mixins`）

##### 1个网络请求模块

